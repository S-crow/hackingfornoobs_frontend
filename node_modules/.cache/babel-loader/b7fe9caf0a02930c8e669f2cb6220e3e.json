{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Nico\\\\hackingfornoobs_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Nico\\\\hackingfornoobs_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Nico\\\\hackingfornoobs_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Nico\\\\hackingfornoobs_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\Nico\\\\hackingfornoobs_frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import Fuzzbunch from\"../img/fuzzbunch.jpg\";import Eternalblue from\"../img/eternalblue.PNG\";import Help from\"../img/help_sneakymercury.PNG\";import Demo from\"../img/demo_sneakymercury.PNG\";import Interactive from\"../img/interactive.PNG\";import NSA from\"../img/nsa.svg\";import Flow from\"../img/flow.PNG\";import EternalblueSuccess from\"../img/eternalbluesuccess.jpg\";var SneakyMercury=/*#__PURE__*/function(_React$Component){_inherits(SneakyMercury,_React$Component);function SneakyMercury(){_classCallCheck(this,SneakyMercury);return _possibleConstructorReturn(this,_getPrototypeOf(SneakyMercury).apply(this,arguments));}_createClass(SneakyMercury,[{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"article\"},React.createElement(\"h1\",null,\"Projet SneakyMercury\"),React.createElement(\"h2\",{style:{\"font-size\":\"200%\",\"font-family\":\"Proxima Nova Soft\",\"text-align\":\"center\"}},\"(Post-exploitation dans les r\\xE9seaux Windows)\"),React.createElement(\"hr\",null),React.createElement(\"div\",null,React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"a\",{href:\"#projet\"},\"Le projet\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"#PTH\"},\"Pass-The-Hash\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"#smb\"},\"Le protocole SMB\")))),React.createElement(\"div\",{className:\"sneaky_article\"},React.createElement(\"h2\",null,\"Le Shadow Brokers Leak\"),React.createElement(\"p\",{className:\"tabulation\"},\"Ces derni\\xE8res ann\\xE9es ont vu l'\\xE9mergence de cyberattaques de plus en plus sophistiqu\\xE9es. Les attaquants comme les agences gouvernementales se servent d'outils customs d\\xE9velopp\\xE9s en interne, qui sont parfois sujet \\xE0 des fuites publiques.\",React.createElement(\"p\",null),React.createElement(\"p\",{className:\"tabulation\"}),\"L'une d'entre elles a particuli\\xE8rement marqu\\xE9 les esprits, le \",React.createElement(\"strong\",null,\"Shadow Brokers Leak,\"),\" qui contenait les exploits et outils utilis\\xE9s par la NSA (National Security Agency) et en particulier ceux concernant le \",React.createElement(\"strong\",null,\"protocole SMB\"),\". Ces exploits d\\xE9nomm\\xE9s EternalBlue, EternalChampion, EternalRomance et EternalSynergy ont \\xE9t\\xE9 ensuite r\\xE9-impl\\xE9ment\\xE9s dans des campagnes d'attaques comme le ransomware \",React.createElement(\"strong\",null,\"WannaCry\"),\". \"),React.createElement(\"img\",{id:\"nsa\",src:NSA,alt:\"NSA\"}),React.createElement(\"h2\",null,\"Le contexte g\\xE9n\\xE9ral\"),React.createElement(\"p\",{className:\"tabulation\"},\"Le leak des Shadow Brokers est une s\\xE9rie de 2 fuites d\\u2019outils de la NSA survenues en Ao\\xFBt 2016 et Avril 2017. Ces leaks contenaient plusieurs exploits et outils qui furent vol\\xE9s semble-t-il \\xE0 \",React.createElement(\"strong\",null,\"l\\u2019Equation Group\"),\", le groupe op\\xE9rationnel cyber de la NSA. Cela inclut notamment le fameux exploit \",React.createElement(\"strong\",null,\"EternalBlue\"),\" qui n'a eu de cesse depuis de faire parler de lui. \"),React.createElement(\"p\",null,\"Les Shadows Brokers annonc\\xE8rent publiquement la fuite le 13 ao\\xFBt 2016 sur plusieurs sites et forums comme teaser de la fuite suivante d'autres outils qu\\u2019ils avaient \\xE9galement en leur possession. \"),React.createElement(\"p\",null,\"Finalement le 14 avril 2017 fut release le dossier \",React.createElement(\"strong\",null,\"Lost in Translation\"),\". En 2017, plusieurs cyberattaques ont \\xE9t\\xE9 lanc\\xE9es apr\\xE8s cet \\xE9v\\xE9nement, notamment les fameux ransomwares \",React.createElement(\"strong\",null,\"WannaCry\"),\" et \",React.createElement(\"strong\",null,\"NotPetya\"),\". \"),React.createElement(\"br\",null),React.createElement(\"h2\",null,\"Les outils de la NSA\"),React.createElement(\"p\",null,\"La premi\\xE8re partie de notre stage consistait en l\\u2019\\xE9tude des diff\\xE9rents outils de la NSA, nous nous sommes particuli\\xE8rement concentr\\xE9s sur 3 outils : \"),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"FUZZBUNCH :\"),\" Framework comparable \\xE0 Metasploit. G\\xE9n\\xE9ralement utilis\\xE9 pour g\\xE9n\\xE9rer des payloads customs (charge utile servant \\xE0 infecter une machine cible).\"),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"DOUBLEPULSAR :\"),\" Payload utilis\\xE9 avec les exploits SMB. Il s\\u2019agit d\\u2019une backdoor7 qui offre des fonctionnalit\\xE9s comme l\\u2019injection de DLL8 ou l\\u2019ex\\xE9cution de code malveillant sur les machines infect\\xE9es. Il est utilis\\xE9 pour installer PeddleCheap qui est un listener9 qui se connecte en retour \\xE0 Danderspritz. \"),React.createElement(\"p\",null,React.createElement(\"strong\",null,\"DANDERSPRITZ :\"),\" Framework graphique de post-exploitation, il couvre entre autre la reconnaissance, la d\\xE9couverte du r\\xE9seau, la d\\xE9tection d\\u2019antivirus, l\\u2019extraction de donn\\xE9es, la persistance et plein d\\u2019autres fonctionnalit\\xE9s. \"),React.createElement(\"div\",null,\"Parmi les diff\\xE9rentes fonctionnalit\\xE9s : \",React.createElement(\"br\",null),React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Monitoring des services sur la machine victime\"),React.createElement(\"li\",null,\"R\\xE9cup\\xE9ration d\\u2019informations sur les drivers\"),React.createElement(\"li\",null,\"Liste des logiciels et des services en cours d\\u2019ex\\xE9cution\"),React.createElement(\"li\",null,\"Liste des antivirus pr\\xE9sents\"),React.createElement(\"li\",null,\"Gestion de netstat\"),React.createElement(\"li\",null,\"Dump de mots de passe \"))),React.createElement(\"p\",null,\"Afin de faciliter le monitoring des h\\xF4tes infect\\xE9s, plusieurs options sont disponibles pour pr\\xE9venir et alerter les analystes\"),React.createElement(\"p\",null,\"Danderspritz offre \\xE9galement des modules d\\xE9di\\xE9s \\xE0 l\\u2019Active Directory (\\xE9num\\xE9ration des utilisateurs, des partages r\\xE9seau, etc) et aux mouvements lat\\xE9raux.\"),React.createElement(\"div\",null,\"R\\xE9sum\\xE9 d'une attaque lanc\\xE9e \\xE0 partir de ces outils :\",React.createElement(\"ol\",null,React.createElement(\"li\",null,\"La victime est infect\\xE9e avec la backdoor \",React.createElement(\"strong\",null,\"Doublepulsar\"),\" via un exploit (\",React.createElement(\"strong\",null,\"EternalBlue\"),\" par exemple)\"),React.createElement(\"li\",null,\"Le listener \",React.createElement(\"strong\",null,\"PeddleCheap\"),\" est lanc\\xE9 dans l\\u2019interface graphique \",React.createElement(\"strong\",null,\"Danderspritz\"),\".\"),React.createElement(\"li\",null,\"PeddleCheap est upload\\xE9 via la backdoor DoublePulsar.\"),React.createElement(\"li\",null,\"PeddleCheap est ex\\xE9cut\\xE9 et se connecte au listener\")),\"[Diagramme Post-exploitation NSA]\"),React.createElement(\"br\",null),React.createElement(\"h2\",null,\"D\\xE9monstration des outils \"),React.createElement(\"p\",null,\"L\\u2019interface de base de Fuzzbunch est assez user-friendly : \"),React.createElement(\"div\",null,React.createElement(\"img\",{id:\"fuzzbunch\",src:Fuzzbunch,alt:\"Fuzzbunch d\\xE9mo\"})),\"-> \",React.createElement(\"a\",{href:\"https://www.digital.security/fr/blog/dans-la-boite-outils-dequation-group\"},\"article Digital Security sur l'Equation Group\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",null,\"Apr\\xE8s avoir renseign\\xE9 certains champs, comme l\\u2019adresse IP cible ou le port d\\u2019\\xE9coute, on peut lancer des plugins qui s\\u2019organisent en diff\\xE9rentes cat\\xE9gories :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Reconnaissance\"),\" (fingerprinting) et check des vuln\\xE9rabilit\\xE9s exploitables sur la cible : Rpctouch, Smbtouch, et d\\u2019autres outils de reconnaissance \"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Exploitation de vuln\\xE9rabilit\\xE9s\"),\" : Emeraldthread ou la suite Eternal*\"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Post-exploitation\"),\" apr\\xE8s infection de l\\u2019h\\xF4te : DouplePulsar \")),\"RpcTouch permet de r\\xE9aliser un fingerprinting de la cible, Smbtouch en plus de r\\xE9cup\\xE9rer la version et l\\u2019architecture du syst\\xE8me d\\u2019exploitation remonte directement les vuln\\xE9rabilit\\xE9s exploitables sur la machine cible.\"),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Dans l'exemple suivant, la cible est vuln\\xE9rable \\xE0 3 exploits dont EternalBlue :\"),React.createElement(\"img\",{id:\"eternalblue_img\",src:Eternalblue,alt:\"eternalblue success\"}),React.createElement(\"p\",{className:\"tabulation\"},\"L\\u2019attaque a r\\xE9ussi, et n\\u2019aura pris qu\\u2019un peu plus de 10 secondes. EternalBlue exploite un buffer overflow au niveau de la stack SMB et s'ex\\xE9cute au niveau du Kernel Windows. Apr\\xE8s on peut d\\xE9poser une backdoor sur la cible. \"),React.createElement(\"a\",{href:\"https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue\"},\"D\\xE9tails de l'exploit\"),React.createElement(\"hr\",null),React.createElement(\"h2\",{id:\"projet\"},\"Projet SneakyMercury \"),React.createElement(\"h3\",null,\"Mise en place d'un lab\"),React.createElement(\"p\",{className:\"tabulation\"},\"La mise en place d\\u2019un lab \\xE9tait n\\xE9cessaire au projet afin de pouvoir tester l'outil dans un environnement restreint et contr\\xF4l\\xE9. La plupart des entreprises de s\\xE9curit\\xE9 disposent de laboratoires virtuels comme celui-ci, certains sont \\xE9galement disponibles \\xE0 l\\u2019achat. Nous avons choisi de mettre en place l'architecture d'un r\\xE9seau standard d\\u2019entreprise, \\xE0 savoir un environnement Active Directory avec des serveurs (Windows Server) et des machines clientes (32bits et 64bits). Pour la machine attaquante, on se sert d\\u2019une machine virtuelle (VM) Kali Linux. \"),React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Active Directory\"),\" - Collection de services pour la gestion des groupes, des utilisateurs et des machines. Les utilisateurs et les machines sont regroup\\xE9s dans des domaines (ici testinfra.fr) Tous les services sont g\\xE9r\\xE9s par un unique serveur, \",React.createElement(\"strong\",null,\"le Domain Controller (DC)\")),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"DNS\"),\" - Service n\\xE9cessaire pour le fonctionnement de l\\u2019Active Directory. l'AD se fie \\xE0 une s\\xE9rie d\\u2019enregistrements DNS pour \\xE9tablir quels services sont disponibles sur le domaine et ce qu\\u2019ils fournissent. Ces enregistrements sont g\\xE9r\\xE9s automatiquement.\"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"LDAP\"),\" - (Lightweight Directory Access Protocol) Annuaire de gestion des utilisateurs pr\\xE9sents sur le r\\xE9seau. \"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Kerberos\"),\" - Service cl\\xE9 responsable de tout ce qui est authentification sur le domaine. Avec le SSO (Single Sign On) il est possible d'utiliser les m\\xEAmes identifiants pour se connecter sur tous les ordinateurs du domaine.\")),React.createElement(\"p\",null,\"L\\u2019ensemble de ces services sont installables lors de la mise en place d\\u2019un Active Directory :\"),React.createElement(\"a\",{href:\"https://www.psattack.com/articles/20160718/setting-up-an-active-directory-lab-part-1/ \"},\"Mise en place d'un AD\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"h3\",null,\"Un outil de post-exploitation pour les r\\xE9seaux Windows\"),React.createElement(\"p\",{className:\"tabulation\"},\"L\\u2019objectif de ce projet est de d\\xE9velopper un nouvel outil opensource afin d\\u2019automatiser la phase de mouvement lat\\xE9ral dans un environnement r\\xE9seau Windows avec Active Directory. L'outil devra \\xEAtre comparable en termes de fonctionnalit\\xE9s \\xE0 l\\u2019outil existant \",React.createElement(\"strong\",null,\"CrackMapExec\"),\" (CME) mais il devra \\xEAtre d\\xE9velopp\\xE9 en RUST plut\\xF4t qu\\u2019en Python comme c'est le cas pour CME.\"),React.createElement(\"a\",{href:\"https://github.com/byt3bl33d3r/CrackMapExec \"},\"github de CrackMapExec\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Rust est un langage relativement r\\xE9cent d\\xE9velopp\\xE9 par la fondation Mozilla mais qui poss\\xE8de d\\xE9j\\xE0 de nombreux contributeurs sur GitHub.\"),React.createElement(\"div\",null,React.createElement(\"strong\",null,\"Les avantages d\\u2019un d\\xE9veloppement en RUST ?\"),\" \",React.createElement(\"br\",null),React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Facilit\\xE9 de d\\xE9ploiement\"),\" : Pas besoin d\\u2019environnement d\\u2019ex\\xE9cution (portable et multiplateforme), pas de d\\xE9pendance, on compile le programme vers un binaire ex\\xE9cutable qu\\u2019on peut d\\xE9ployer sur le r\\xE9seau cible.\"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"Rapidit\\xE9\"),\" : Rust est un langage bas niveau, tr\\xE8s optimis\\xE9 par rapport au langage Python \"),React.createElement(\"li\",null,React.createElement(\"strong\",null,\"S\\xE9curit\\xE9\"),\" : Rust combine programmation bas niveau avec s\\xFBret\\xE9 m\\xE9moire, (pas de garbage collector). Le compilateur garantit que le code est memory safe. La syntaxe du langage et les v\\xE9rifications du compilateur emp\\xEAchent \\xE9norm\\xE9ment d\\u2019erreurs, pas d\\u2019overflow ni de race condition ou autres corruptions m\\xE9moire.\"))),React.createElement(\"ul\",{id:\"list-links\"},React.createElement(\"li\",null,React.createElement(\"a\",{href:\" https://doc.rust-lang.org/book/ \"},\"Rust Book\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"https://doc.rust-lang.org/rust-by-example/ \"},\"Rust by example\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"https://aml3.github.io/RustTutorial/\"},\"Rust in 7 programs\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\" https://llogiq.github.io/2015/07/30/traits.html \"},\"Rust built-in traits\"))),React.createElement(\"div\",null,React.createElement(\"strong\",null,\"Cahier des charges pour l\\u2019outil :\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Authentification sur le r\\xE9seau Windows : NTLM, Kerberos, Bruteforce de comptes \"),React.createElement(\"li\",null,\"\\xC9num\\xE9ration : de partages r\\xE9seaux, d'utilisateurs, de groupes et d\\u2019autres informations utiles.\"),React.createElement(\"li\",null,\"Commandes : Upload/Download de fichiers, shell interactif des fonctionnalit\\xE9s de l\\u2019outil \"),React.createElement(\"li\",null,\"Ex\\xE9cution de code \\xE0 distance : PSExec et LOLBAS (Living Off The Land Binaries And Scripts), ensemble de techniques furtives qui se servent des ex\\xE9cutables l\\xE9gitimes pr\\xE9sents sur le syst\\xE8me.\"))),React.createElement(\"h3\",null,\"D\\xE9veloppement d\\u2019une biblioth\\xE8que SMB en Rust\"),React.createElement(\"p\",{className:\"tabulation\"},\"Contrairement \\xE0 \",React.createElement(\"strong\",null,\"CrackMapExec\"),\" (CME) qui pouvait compter sur la biblioth\\xE8que SMB en Python \",React.createElement(\"strong\",null,\"Impacket\"),\", Rust \\xE9tant un langage relativement r\\xE9cent, il n\\u2019y a pas de biblioth\\xE8que SMB d\\xE9j\\xE0 exitante. La principale difficult\\xE9 a donc \\xE9t\\xE9 la r\\xE9impl\\xE9mentation from scratch du protocole SMB en Rust. Il s\\u2019agissait de comprendre le protocole, les m\\xE9canismes de gestion de l\\u2019authentification sous Windows et de recrafter chaque paquet pour effectuer telle ou telle action.\"),React.createElement(\"div\",null,\"SMB (Server Message Block) est le protocole des partages Windows, il inclut notamment :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"L\\u2019acc\\xE8s aux Partages r\\xE9seau (shares)\"),React.createElement(\"li\",null,\"La gestion des imprimantes \"),React.createElement(\"li\",null,\"L\\u2019administration de machines distantes \"),React.createElement(\"li\",null,\"La lecture et l\\u2019\\xE9criture de fichiers \"))),React.createElement(\"p\",{className:\"tabulation\"},\"SMB peut \\xE9galement fonctionner comme protocole de transport avec d\\u2019autres protocoles r\\xE9seau Windows. Par exemple le protocole Windows Remote Procedure Call (DCE RPC) permet la communication interprocess. Les diff\\xE9rents processus peuvent \\xEAtre sur la m\\xEAme machine, sur le m\\xEAme r\\xE9seau local ou m\\xEAme selon la configuration, \\xE0 travers le net. Cela nous permet donc l\\u2019ex\\xE9cution de code \\xE0 distance, le management de services ou la gestion ou la modification de cl\\xE9s de registres Windows.\"),React.createElement(\"p\",null,\"Pour impl\\xE9menter la 1\\xE8re biblioth\\xE8que SMB libre en RUST nous nous sommes bas\\xE9s sur Impacket qui en propose d\\xE9j\\xE0 une existante en Python et sur la documentation de Microsoft associ\\xE9e au protocole SMB.\"),React.createElement(\"hr\",null),React.createElement(\"h2\",null,\"Utilisation de l\\u2019outil\"),React.createElement(\"div\",{className:\"tabulation\"},\"SneakyMercury est un outil en CLI, l\\u2019interface offre un shell int\\xE9ractif. Quand l\\u2019utilisateur lance l\\u2019outil il acc\\xE8de au menu d\\u2019aide lui indiquant les options \\xE0 fournir (IP cible, nom d\\u2019utilisateur, mot de passe, nom de domaine)\",React.createElement(\"br\",null),\"\\u2192 Les commandes shell, script et db sont alors disponibles\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"shell ouvre un shell int\\xE9ractif avec un menu d\\u2019aide plus sp\\xE9cifique\"),React.createElement(\"li\",null,\"script permet \\xE0 un utilisateur de lancer ses propres scripts\"),React.createElement(\"li\",null,\"db g\\xE8re en background une base de donn\\xE9es contenant les credentials d\\xE9j\\xE0 r\\xE9cup\\xE9r\\xE9s (fonctionnalit\\xE9 non impl\\xE9ment\\xE9e)\"))),React.createElement(\"img\",{id:\"help\",src:Help,alt:\"menu d'aide sneakymercury\"}),React.createElement(\"p\",null,\"L\\u2019outil traite l\\u2019authentification NTLMv2 et retourne un message de connexion ou d\\u2019erreur. L\\u2019utilisateur connect\\xE9 acc\\xE8de alors \\xE0 la liste des commandes disponibles.\"),React.createElement(\"img\",{id:\"demo\",src:Demo,alt:\"demo sneakymercury\"}),React.createElement(\"div\",null,\"G\\xE9n\\xE9ralement la commande suivante est \\xAB Connect \\xBB qui va permettre la connexion \\xE0 un partage r\\xE9seau (share). Par d\\xE9faut, il y a 3 partages r\\xE9seau, visibles uniquement par l\\u2019administrateur du domaine ou l\\u2019administrateur local. Pour pouvoir monter ces partages r\\xE9seau il faut avoir les droits administrateur sur le syst\\xE8me.\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"C$ (Disque C)\"),React.createElement(\"li\",null,\"ADMIN$ = C:/Windows/\"),React.createElement(\"li\",null,\"IPC$\")),\"$=cach\\xE9\"),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"tabulation\"},\"IPC$ est un partage sp\\xE9cial permettant la communication interprocess. Il ne permet pas d\\u2019acc\\xE9der directement \\xE0 des fichiers ou des dossiers comme les autres partages r\\xE9seau mais il fournit une interface de communication avec les autres processus en cours d\\u2019ex\\xE9cution sur le syst\\xE8me (Remote Procedure Call : DCERPC). En fait $IPC expose les named pipes11 sur lesquels on peut alors \\xE9crire ou lire pour communiquer avec les processus. Chaque data qui est \\xE9crite sur un named pipe est envoy\\xE9e au processus distant et inversement chaque data \\xE9crite par un processus sera accessible \\xE0 partir du named pipe associ\\xE9. Une fois connect\\xE9 au partage r\\xE9seau l\\u2019utilisateur peut lister les fichiers ou se d\\xE9placer dans les diff\\xE9rents dossiers \\xE0 la recherche de donn\\xE9es sensibles.\"),React.createElement(\"h3\",null,\"Exploration des partages r\\xE9seau et commandes Powershell \"),React.createElement(\"p\",{className:\"tabulation\"},\"On peut \\xE9galement ex\\xE9cuter des commandes arbitraires sur la cible gr\\xE2ce \\xE0 la commande PowerShell :\"),React.createElement(\"img\",{id:\"interactif\",src:Interactive,alt:\"sneakymercury interactif\"}),React.createElement(\"h3\",null,\"Download de fichiers ou upload de codes malveillants\"),React.createElement(\"p\",{className:\"tabulation\"},\"La fonctionnalit\\xE9 impl\\xE9ment\\xE9e suivante est l\\u2019\",React.createElement(\"strong\",null,\"Upload/Download\"),\" de fichiers. Cela peut permettre \\xE0 l\\u2019utilisateur de r\\xE9cup\\xE9rer les fichiers int\\xE9ressants en local avec la commande download, ou alternativement d'uploader ses propres fichiers ou ex\\xE9cutables via la commande upload.\"),React.createElement(\"p\",null,\"Pour impl\\xE9menter cette fonctionnalit\\xE9 nous nous sommes inspir\\xE9s de l\\u2019upload utilis\\xE9 par CrackMapExec (CME).\"),React.createElement(\"ul\",null,React.createElement(\"strong\",null,\"D\\xE9tails upload CME :\"),React.createElement(\"li\",null,\"Premi\\xE8re \\xE9tape, connexion au share o\\xF9 l\\u2019on veut uploader (ex : ADMIN$)\"),React.createElement(\"li\",null,\"Cr\\xE9ation d\\u2019un fichier (Create Request File) \"),React.createElement(\"li\",null,\"Ecriture du fichier, on bufferise les donn\\xE9es pour les envoyer en boucle si n\\xE9cessaire (Write Request)\"),React.createElement(\"li\",null,\"Fermeture (Close Request)\")),React.createElement(\"p\",{className:\"tabulation\"},\"Le sch\\xE9ma pr\\xE9sente les \\xE9tapes pour ouvrir un fichier sur la machine distante, y \\xE9crire, et le fermer. On fait l\\u2019hypoth\\xE8se qu\\u2019une connexion authentifi\\xE9e est d\\xE9j\\xE0 \\xE9tablie avant l\\u2019envoi de ces paquets, l\\u2019\\xE9tablissement de la session et la connexion au partage r\\xE9seau ont donc d\\xE9j\\xE0 eu lieu :\"),React.createElement(\"p\",null,\"[Diagramme d'un upload]\"),React.createElement(\"p\",{className:\"tabulation\"},\"La premi\\xE8re requ\\xEAte permet la cr\\xE9ation d'un fichier sur la machine distante. La seconde va initialiser certaines m\\xE9tadonn\\xE9es du fichier comme sa taille. On envoie des requ\\xEAtes d\\u2019\\xE9criture dans lesquelles on bufferise les data \\xE0 transmettre, et l\\u2019on boucle jusqu\\u2019\\xE0 la fin du fichier source. Une derni\\xE8re requ\\xEAte permet la fermeture du fichier distant. L\\u2019upload est alors termin\\xE9.\"),React.createElement(\"h3\",null,\"Enum\\xE9ration des utilisateurs, des domaines et des sessions\"),React.createElement(\"p\",{className:\"tabulation\"},\"Si l\\u2019objectif est la reconnaissance locale ou sur le domaine, l\\u2019utilisateur peut utiliser les commandes \",React.createElement(\"strong\",null,\"domains\"),\" ou \",React.createElement(\"strong\",null,\"users\"),\". Elles listent respectivement les domaines auxquels les utilisateurs peuvent se connecter, et les utilisateurs enregistr\\xE9s. D\\u2019autre part si elle est utilis\\xE9e sur un Contr\\xF4leur de Domaine, la commande users peut lister tous les utilisateurs du domaine :  \"),React.createElement(\"p\",null,\"[Diagramme liste users]\"),React.createElement(\"div\",null,\"Cette fonctionnalit\\xE9 est bas\\xE9e sur le protocole \",React.createElement(\"strong\",null,\"SAMR\"),\" (Security Account Manager Remote) avec les requ\\xEAtes suivantes :\",React.createElement(\"ol\",null,React.createElement(\"li\",null,\"Connect request\"),React.createElement(\"li\",null,\"EnumDomains\"),React.createElement(\"li\",null,\"LookupDomain\"),React.createElement(\"li\",null,\"OpenDomain\"),React.createElement(\"li\",null,\"EnumDomainUsers\"),React.createElement(\"li\",null,\"OpenUser\"),React.createElement(\"li\",null,\"QueryUserInfo2\"),React.createElement(\"li\",null,\"Close request \"))),React.createElement(\"p\",{className:\"tabulation\"},\"Une requ\\xEAte va initialiser la connexion, la suivante liste les domaines, on parse alors la r\\xE9ponse pour se concentrer sur un domaine en particulier. On ouvre ce domaine et une requ\\xEAte va r\\xE9aliser l\\u2019\\xE9num\\xE9ration des utilisateurs sur celui-ci. Enfin on peut r\\xE9cup\\xE9rer certaines informations sp\\xE9cifiques \\xE0 un utilisateur, avant de fermer avec la derni\\xE8re requ\\xEAte\"),React.createElement(\"p\",null,\"La capture Wireshark ci-dessous pr\\xE9sente les requ\\xEAtes SAMR dans l\\u2019ordre logique pour lister les utilisateurs.\"),React.createElement(\"p\",null,\"[Diagramme wireshark \\xE9num users\"),React.createElement(\"p\",{className:\"tabulation\"},\"Pour notre projet nous avons analys\\xE9 les paquets en utilisant WireShark (logiciel d\\u2019\\xE9coute passive et de capture de paquets r\\xE9seau). Afin d\\u2019impl\\xE9menter une action particuli\\xE8re (comme l\\u2019\\xE9num\\xE9ration des utilisateurs), il faut envoyer au serveur les paquets dans un ordre pr\\xE9cis, avec des param\\xE8tres corrects et les valeurs correspondantes. On a donc du diss\\xE9quer le protocole pour comprendre les fonctions des diff\\xE9rents paquets ainsi que les effets des diff\\xE9rents param\\xE8tres.\"),React.createElement(\"p\",null,\"Wireshark et les tests unitaires ont permis de d\\xE9celer les \\xE9ventuelles erreurs de valeurs dans les param\\xE8tres des paquets ou dans le parsing des r\\xE9ponses. Cette m\\xE9thodologie pour construire les paquets, les envoyer sur le r\\xE9seau et parser les r\\xE9ponses, reste valable quelque soit le protocole \\xE9tudi\\xE9.\"),React.createElement(\"hr\",null),React.createElement(\"h2\",null,\"Fonctionnalit\\xE9s additionnelles\"),React.createElement(\"h3\",null,\"Windows Remote Code Execution \"),React.createElement(\"div\",null,\"Plusieurs m\\xE9thodes sont possibles pour l\\u2019ex\\xE9cution de code \\xE0 distance sous Windows :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Remote Service Control Manager (Named pipe : svcctl)\"),React.createElement(\"li\",null,\"Task Scheduler (atexec)\"),React.createElement(\"li\",null,\"Windows Management Instrumentation (WMI)\"),React.createElement(\"li\",null,\"Remote Registry\"),React.createElement(\"li\",null,\"Remote File Access\"),React.createElement(\"li\",null,\"Remote Desktop (RDP)\"),React.createElement(\"li\",null,\"Windows Remote Management\"),React.createElement(\"li\",null,\"MMC20.Application (DCOM) \"))),React.createElement(\"p\",null,\"Ces diff\\xE9rentes m\\xE9thodes sont expliqu\\xE9es dans ce lien :\"),React.createElement(\"a\",{href:\"https://support.microsoft.com/en-us/help/942817/how-to-change-the-remote-uaclocalaccounttokenfilterpolicy-registry-se\"},\"M\\xE9thodes d'ex\\xE9cution de code \\xE0 distance\"),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Pour ce projet l\\u2019ex\\xE9cution de code \\xE0 distance se fait via le protocole \",React.createElement(\"strong\",null,\"SCMR\"),\" (Service Control Manager Remote Protocol) en se basant sur \",React.createElement(\"strong\",null,\"Psexec\"),\" de \",React.createElement(\"strong\",null,\"SysInternals\"),\".\"),React.createElement(\"p\",{className:\"tabulation\"},\"L\\u2019utilisation de commandes internes propres \\xE0 Windows (l\\xE9gitimes) permet d\\u2019\\xE9viter d\\u2019\\xE9crire des fichiers sur le disque (Fileless) donc est une m\\xE9thode plus discr\\xE8te pour \\xE9viter les d\\xE9tections via des m\\xE9canismes comme l\\u2019AMSI (Antimalware Scan Interface) ou les sondes IDS\"),React.createElement(\"div\",null,\"Smb-exec (utilis\\xE9 par CME) permet \\xE9galement d\\u2019ex\\xE9cuter du code sur des h\\xF4tes distants. Parmi ses fonctionnalit\\xE9s :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Dump de hash12 sur les serveurs et machines\"),React.createElement(\"li\",null,\"Enregistrement des registres HKLM (HKEY_LOCAL_MACHINE) et de la base SAM (Security Account Manager)\"),React.createElement(\"li\",null,\"Recherche de fichiers int\\xE9ressants (ex : unattended.xml contenant souvent des mots de passe en clair)\"))),React.createElement(\"p\",null,\"Il a \\xE9galement l\\u2019avantage d\\u2019\\xEAtre peu d\\xE9tect\\xE9 en comparaison des payloads du framework Metasploit (bas\\xE9 sur psexec de SysInternals). \",React.createElement(\"br\",null),\"   \",React.createElement(\"br\",null),React.createElement(\"a\",{href:\"https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbexec.py\"},\"github de smbexec\")),React.createElement(\"br\",null),React.createElement(\"div\",null,React.createElement(\"strong\",null,\"D\\xE9tails de Smb-exec:\"),React.createElement(\"ol\",null,React.createElement(\"li\",null,\"Premi\\xE8re \\xE9tape, connexion \\xE0 IPC$ et cr\\xE9ation svcctl (Create Request)\"),React.createElement(\"li\",null,\"R\\xE9cup\\xE9ration du Context Handle (Open SC Manager Request)\"),React.createElement(\"li\",null,\"Cr\\xE9ation d\\u2019un Named service sp\\xE9cifiant la commande \\xE0 ex\\xE9cuter dans le path du binaire (Create Service Request). Cette commande redirige l'output vers des fichiers temporaires qui seront t\\xE9l\\xE9charg\\xE9s ensuite.\"),React.createElement(\"li\",null,\"D\\xE9marrage du service (Start Service)\"),React.createElement(\"li\",null,\"Lecture de l'output \\xE9crite dans le fichier temporaire (Read Request)\"),React.createElement(\"li\",null,\"Suppression du service (Delete Service) \"),React.createElement(\"li\",null,\"Fermeture de l\\u2019handle attribu\\xE9 (Close Handle Request)\"))),React.createElement(\"p\",{className:\"tabulation\"},\"Psexec (d\\xE9velopp\\xE9 par SysInternals), il s\\u2019agit d\\u2019un outil d\\u2019administration \\xE0 distance de Windows, qui a longtemps \\xE9t\\xE9 l\\u2019outil favori pour tous les mouvements lat\\xE9raux dans un environnement Active Directory. Il utilise le protocole SMB pour se connecter \\xE0 une machine distante et y lancer un ex\\xE9cutable. En principe, il cr\\xE9e un \\xAB named pipe \\xBB qui permet d\\u2019ex\\xE9cuter de mani\\xE8re interactive des commandes avec RemComSvc. En r\\xE9alit\\xE9 il les ex\\xE9cute localement puis exporte les r\\xE9sultats \\xE0 travers SMB. Bien qu\\u2019il soit encore utilis\\xE9 de mani\\xE8re l\\xE9gitime pour effectuer des t\\xE2ches d\\u2019administration il facilite grandement la t\\xE2che aux attaquants. \"),React.createElement(\"p\",null,\"Voici l\\u2019explication d\\xE9taill\\xE9e tir\\xE9e du blog rapid7 : \\u201DPSExec has a Windows Service image inside of its executable. It takes this service and deploys it to the Admin share on the remote machine. It then uses the DCE/RPC interface over SMB to access the Windows Service Control Manager API. It turns on the PSExec service on the remote machine. The PSExec service then creates a named pipe that can be used to send commands to the system.\\u201D \"),React.createElement(\"a\",{href:\"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec\"},\"Documentation Microsoft Psexec\"),React.createElement(\"br\",null),React.createElement(\"a\",{href:\"https://blog.rapid7.com/2013/03/09/psexec-demystified/\"},\"Explications Psexec additionnelles\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"strong\",null,\"D\\xE9tails des \\xE9tapes de Psexec : \"),\"Comparable \\xE0 Smbexec mais diff\\xE8re dans le fait qu\\u2019il upload toujours un fichier sur la machine distante.\",React.createElement(\"ol\",null,React.createElement(\"li\",null,\"Cr\\xE9ation de psexecsvc.exe sur le share $ADMIN (Create Request File)\"),React.createElement(\"li\",null,\"\\xC9criture sur psexcsv de la commande \\xE0 ex\\xE9cuter sur le fichier local ou des data du binaire \\xE0 uploader (Write Request) \"),React.createElement(\"li\",null,\"Connexion \\xE0 SCMR via DCERPC (Bind Request)\"),React.createElement(\"li\",null,\"R\\xE9cup\\xE9ration du context handle \"),React.createElement(\"li\",null,\"Cr\\xE9ation du service, chiffr\\xE9 sous Wireshark (Create Service Request)\"),React.createElement(\"li\",null,\"Fermeture du service (Close Service Handle Request)\"),React.createElement(\"li\",null,\"Commande (Open Service Request)\"),React.createElement(\"li\",null,\"D\\xE9marrage du service (Start Service Request)\"),React.createElement(\"li\",null,\"Requ\\xEAte le statut du service (Query Service Status Request)\"),React.createElement(\"li\",null,\"Cr\\xE9ation de PSEXESVC (Create Request File)\"),React.createElement(\"li\",null,\"R\\xE9cup\\xE9ration d\\u2019information (Info Request/ IOCTL Request)\"),React.createElement(\"li\",null,\"\\xC9criture des data (Write Request)\"),React.createElement(\"li\",null,\"Lecture des data (Read Request)\"),React.createElement(\"li\",null,\"Cr\\xE9ation du fichier pour stdin (Create Request)\"),React.createElement(\"li\",null,\"Cr\\xE9ation du fichier pour stdout (Create Request)\"),React.createElement(\"li\",null,\"Cr\\xE9ation du fichier pour stderr (Create Request)\")),\"Apr\\xE8s chaque commande : \\xE9criture sur stdin (Write Request) et lecture sur stdout (Read Request)\",React.createElement(\"img\",{id:\"flow\",src:Flow,alt:\"flowgraph\"}),React.createElement(\"h2\",{id:\"PTH\"},\"Pass The Hash (PTH)\"),React.createElement(\"p\",{className:\"tabulation\"},\"L\\u2019utilisateur peut \\xE9galement choisir de s\\u2019authentifier en utilisant un hash de mot de passe (NTLMv2), cela permet tout ce qui est attaque du type Pass-The-Hash. Les m\\xE9canismes d'authentification sont bas\\xE9s sur un mot de passe que la plupart du temps les utilisateurs ne doivent saisir qu'une seule et unique fois. Ce dernier sera hash\\xE9 et c\\u2019est ce hash qui sera utilis\\xE9 par la suite.  Ainsi pour un attaquant cela revient au m\\xEAme de conna\\xEEtre la valeur du hash ou bien le mot de passe lui-m\\xEAme. Une attaque Pass-The-Hash facilite grandement les intrusions dans un r\\xE9seau dans la mesure o\\xF9 m\\xEAme les mots de passe d\\u2019une grande complexit\\xE9 peuvent \\xEAtre facilement contourn\\xE9s.\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,\" \",React.createElement(\"a\",{href:\"https://www.melani.admin.ch/melani/fr/home/documentation/rapports/rapportstechniques/attaques--pass-the-hash-.html \"},\"documentation pass the hass\")),React.createElement(\"li\",null,\"   \",React.createElement(\"a\",{href:\"https://attack.stealthbits.com/pass-the-hash-attack-explained \"},\"explications pass the hash\"))),React.createElement(\"p\",{className:\"tabulation\"},\"Par ailleurs, les attaques Pass-The-Hash sont tr\\xE8s difficiles \\xE0 d\\xE9tecter au niveau du r\\xE9seau car il est complexe de savoir quel utilisateur devrait \\xEAtre loggu\\xE9 sur telle machine et de pratiquer une politique de s\\xE9curit\\xE9 assez fiable pour savoir \\xE0 tout moment quels comptes ont droit d\\u2019acc\\xE8s \\xE0 telle ressource.\"),React.createElement(\"h2\",null,\"Null Session\"),React.createElement(\"p\",{className:\"tabulation\"},\"Il s\\u2019agit d\\u2019une vuln\\xE9rabilit\\xE9 classique dans les r\\xE9seaux Windows qui consiste \\xE0 se connecter en connexion anonyme \\xE0 un partage r\\xE9seau cach\\xE9 IPC$ (share r\\xE9seau utilis\\xE9 pour les communications interprocess). Cela permet ainsi de r\\xE9cup\\xE9rer de nombreuses informations sur la configuration de la machine, les utilisateurs, les noms des partages r\\xE9seau, et m\\xEAme de modifier des parties du registre de la machine distante.\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"a\",{href:\"https://sensepost.com/blog/2018/a-new-look-at-null-sessions-and-user-enumeration/\"},\"lien1\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"https://www.beyondsecurity.com/scan_pentest_network_vulnerabilities_null_session_availab lesmb\"},\"lien2\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"http://smallvoid.com/article/winnt-null-session.html\"},\"lien3\")),React.createElement(\"li\",null,\" \",React.createElement(\"a\",{href:\"https://www.youtube.com/watch?v=VvX7JHzzSA8\"},\"lien4\"))),React.createElement(\"p\",{className:\"tabulation\"},\"Pour utiliser la nulle session dans notre outil, il faut changer un flag lors de la n\\xE9gociation de session (afin de rendre la connexion anonyme) et supprimer toutes les r\\xE9ponses au challenge.\"),\"Pour d\\xE9sactiver la nulle session sous Windows, il suffit de modifier le registre comme suit : \",React.createElement(\"br\",null),\"HKEY\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa: \",React.createElement(\"br\",null),\"\\u2013 RestrictAnonymous = 1 \",React.createElement(\"br\",null),\"\\u2013 Restrict AnonymousSAM = 1 \",React.createElement(\"br\",null),\"\\u2013 EveryoneIncludesAnonymous = 0 \",React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",null,\"On peut \\xE9galement limiter ses acc\\xE8s aux partages r\\xE9seau en ajoutant un champ \",React.createElement(\"strong\",null,\"RestrictNullSessAccess\"),\"de valeur 1 dans la cl\\xE9 de registre suivante :\",React.createElement(\"br\",null),React.createElement(\"strong\",{style:{'font-size':'9px'}},\"HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\LanManServer\\\\Parameters\")),React.createElement(\"h2\",null,\"Bruteforce de mots de passe\"),React.createElement(\"p\",{className:\"tabulation\"},\"Pour g\\xE9rer le bruteforce de mots de passe au niveau de l\\u2019authentification SMB on a impl\\xE9ment\\xE9 l'utilisation d'une liste de noms d\\u2019utilisateurs/mots de passe plut\\xF4t qu\\u2019un mot de passe unique afin de tester l\\u2019authentification pour une liste sp\\xE9cifique de cible. Lorsque des identifiants valides sont trouv\\xE9s ils sont automatiquement ajout\\xE9s dans la base de donn\\xE9es qui devrait \\xE0 terme recenser tous les identifiants trouv\\xE9s sur le r\\xE9seau au cours du pentest, y compris les identifiants dans les fichiers des partages r\\xE9seaux (ce qui est arrive fr\\xE9quemment).\"),React.createElement(\"h2\",null,\"La suite Eternal*\"),\"MS17-010 contient les exploits d\\xE9velopp\\xE9s par la NSA qui ciblent Microsoft Windows, ces exploits ont notamment \\xE9t\\xE9 r\\xE9-impl\\xE9ment\\xE9s dans les ransomware WannaCry et NotPetya.\",React.createElement(\"ol\",null,React.createElement(\"li\",null,\"CVE-2017-0146 (EternalChampion/EternalSynergy) : exploite une race condition avec les Transaction requests\"),React.createElement(\"li\",null,\"CVE-2017-0143 (EternalRomance/EternalSynergy) : exploite une confusion de type entre WriteAndX et Transaction requests \")),\"Sous Metasploit : exploit/windows/smb/ms17_010_psexec\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"1. Le pare feu doit permettre le trafic SMB\"),React.createElement(\"li\",null,\"2. La cible doit utiliser la version du protocole SMBv1\"),React.createElement(\"li\",null,\"3. Il ne doit pas y avoir la mise \\xE0 jour du patch de la MS17-010\"),React.createElement(\"li\",null,\"4. La connexion anonyme \\xE0 l\\u2019IPC$ et au named pipe doivent \\xEAtre autoris\\xE9es\")),React.createElement(\"img\",{id:\"eternalbluesuccess\",src:EternalblueSuccess,alt:\"exploit eternalblue\"}),React.createElement(\"p\",{className:\"tabulation\"},\"EternalBlue ne n\\xE9cessite pas d\\u2019\\xEAtre authentifi\\xE9. EternalRomance, EternalSynergy et EternalChampion permettent d\\u2019obtenir une session administrateur \\xE0 partir d\\u2019un compte aux privil\\xE8ges limit\\xE9s. Dans le cadre du projet, EternalBlue a \\xE9t\\xE9 impl\\xE9ment\\xE9 en Rust afin de pouvoir l\\u2019int\\xE9grer dans l\\u2019outil. \"),React.createElement(\"h2\",{id:\"smb\"},\"Server Message Block (SMB)\"),React.createElement(\"h3\",null,\"Pr\\xE9sentation\"),React.createElement(\"p\",{className:\"tabulation\"},\"Il existe plusieurs versions de la suite protocolaire Microsoft SMB : SMB 1, SMB 2.0, SMB 2.1, SMB 3.0, SMB 3.0.2, SMB 3.1.1\",React.createElement(\"br\",null),\"  Les versions SMB 2.X et SMB 3.X sont assez proches mais radicalement diff\\xE9rents de la version SMB1. \",React.createElement(\"br\",null),\"Ce projet s\\u2019est concentr\\xE9 sur l\\u2019impl\\xE9mentation de SMB2.1, le tableau suivant pr\\xE9sente les versions du protocole SMB associ\\xE9es aux diff\\xE9rents syst\\xE8mes d\\u2019exploitation : \"),React.createElement(\"p\",null,\"SMB peut \\xEAtre impl\\xE9ment\\xE9 sur le TCP ou via NETBIOS. Ce projet se concentre sur le SMB over TCP (Direct Hosted SMB). Les paquets seront craft\\xE9s de mani\\xE8re \\xE0 indiquer que le protocole est lanc\\xE9 over TCP avec un header qui pr\\xE9cisera \\xE0 chaque fois l\\u2019action \\xE0 r\\xE9aliser et donc la nature des data qui suivent. \"),React.createElement(\"p\",null,\"Pour notre projet nous nous sommes concentr\\xE9s sur la version SMB2.1 utilisant le header SYNC packets, et uniquement du cot\\xE9 client. Pour se faire nous nous sommes inspir\\xE9s du client smb d\\u2019Impacket ainsi que de la documentation de Windows. \"),React.createElement(\"p\",null,\"En mode sync, un thread lance une op\\xE9ration I/O et entre imm\\xE9diatement dans une phase d\\u2019attente jusqu\\u2019\\xE0 ce que la requ\\xEAte I/O soit achev\\xE9e. \"),React.createElement(\"p\",null,\"Le header SMB (SYNC) se pr\\xE9sente comme suit:\"),\"[Diagramme header SMB]\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"4 premiers octets : identification du protocole SMB2      SMB2:0x424d53fe \"),React.createElement(\"li\",null,\"2 suivants : taille du header\"),React.createElement(\"li\",null,\"2 octets : Credit Charge  0x0000 (valeur fournie par le client au serveur et limite le nombre de requ\\xEAtes exceptionnelles qu\\u2019un client peut envoyer au serveur)\"),React.createElement(\"li\",null,\"2 octets : Channel Sequence 0x0000\"),React.createElement(\"li\",null,\"2 octets : Reserved, 0x0000\"),React.createElement(\"li\",null,\"2 octets : Command (l\\u2019un des param\\xE8tres les plus importants car il d\\xE9crit le type de paquet qui va \\xEAtre envoy\\xE9) \"),React.createElement(\"li\",null,\"2 octets : Credits requested \"),React.createElement(\"li\",null,\"4 octets : flags\",React.createElement(\"br\",null),\"- requ\\xEAte : 0x00000000 \",React.createElement(\"br\",null),\"- r\\xE9ponse : 0x00000001\"),React.createElement(\"li\",null,\"8 octets : message ID \",React.createElement(\"br\",null),\"    - incr\\xE9mentation \\xE0 partir de 0 pour chaque requ\\xEAte envoy\\xE9e \",React.createElement(\"br\",null),\" - logique de suivi au niveau paquets de la communication SMB\"),React.createElement(\"li\",null,\"4 octets : Process ID - 0x0000feff \"),React.createElement(\"li\",null,\"4 octets : Tree ID \",React.createElement(\"br\",null),\" - 0x00 jusqu\\u2019\\xE0 la requ\\xEAte tree connect  \",React.createElement(\"br\",null),\"- 0x01 puis \\xE9gal \\xE0 1 apr\\xE8s connexion\"),React.createElement(\"li\",null,\"8 octets : Session ID \",React.createElement(\"br\",null),\"- 0x00 jusqu\\u2019\\xE0 la requ\\xEAte session setup, apr\\xE8s identifie la session\"),React.createElement(\"li\",null,\"16 octets : Signature ID \",React.createElement(\"br\",null),\"  - utilis\\xE9 si le paquet est sign\\xE9 \")),React.createElement(\"a\",{href:\"https://msdn.microsoft.com/en-us/library/cc246529.aspx\"},\"documentation source\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"tabulation\"},\"Pour les messages, il a fallu les crafter de z\\xE9ro en s\\u2019inspirant de la documentation Microsoft et du code d\\u2019Impacket, voici les diff\\xE9rents paquets relatifs au protocole SMB que l\\u2019on a pu impl\\xE9menter au cours du projet : \"),React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Negotiate: message initial, n\\xE9gociation pour l\\u2019authentification\"),React.createElement(\"li\",null,\"Session Setup: m\\xE9canisme authentification\"),React.createElement(\"li\",null,\"Tree Connect/Disconnect: demande de connexion \\xE0 un Partage r\\xE9seau\"),React.createElement(\"li\",null,\"Logoff: message pour la d\\xE9connexion \"),React.createElement(\"li\",null,\"Read: message de lecture de data \"),React.createElement(\"li\",null,\"Write: message d\\u2019\\xE9criture de data \"),React.createElement(\"li\",null,\"Create: message d\\u2019acc\\xE8s/de cr\\xE9ation/de suppression d\\u2019un fichier\"),React.createElement(\"li\",null,\"Query Directory: r\\xE9cup\\xE9ration d\\u2019information sur un dossier \"),React.createElement(\"li\",null,\"Get Info: r\\xE9cup\\xE9ration d\\u2019informations sur les fichiers et/ou autres objets \")),\"Gr\\xE2ce \\xE0 ces paquets on a ainsi pu impl\\xE9menter les fonctionnalit\\xE9s suivantes :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Ouverture et fermeture d\\u2019une connexion SMB \"),React.createElement(\"li\",null,\" Authentification (combin\\xE9 avec l\\u2019impl\\xE9mentation Windows GSS-API/NTLMSSP) \\u2192 Login \"),React.createElement(\"li\",null,\"Connexion \\xE0 un partage r\\xE9seau \"),React.createElement(\"li\",null,\"Liste des partages r\\xE9seau \"),React.createElement(\"li\",null,\"D\\xE9placement dans les dossiers d\\u2019un partage \"),React.createElement(\"li\",null,\"Upload d\\u2019un fichier sur un partage \"),React.createElement(\"li\",null,\"Download d\\u2019un fichier pr\\xE9sent sur un partage \")),React.createElement(\"h3\",null,\"Authentification\"),\"Le graphe suivant donne une vue d\\u2019ensemble du processus d\\u2019authentification SMB2 (login) :\",React.createElement(\"br\",null),\"[Diagrammme authentification SMB2]\",React.createElement(\"br\",null),React.createElement(\"p\",null,\"Dans le premier paquet le client re\\xE7oit le token GSS du serveur. Il s\\u2019agit d\\u2019un spnego qui est utilis\\xE9 pour choisir le type d\\u2019authentification qui interviendra entre le client et le serveur.\"),React.createElement(\"p\",null,\"SPNEGO est une sp\\xE9cification standard d\\xE9finie dans Simple and Protected GSS-API Negotiation Mechanism, et est en charge de l\\u2019authentification permettant l'acc\\xE8s \\xE0 une ressource s\\xE9curis\\xE9e identifi\\xE9e dans la requ\\xEAte HTTP.\"),\"Le spnego inclut les param\\xE8tres :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"mechtypes : qui d\\xE9crit les m\\xE9canismes de s\\xE9curit\\xE9 disponibles \"),React.createElement(\"li\",null,\"mechtoken : le token relatif \\xE0 la session \"),React.createElement(\"li\",null,\"d\\u2019autres informations\")),\"Dans le cas d\\u2019une session NTLM, le client va initier un nouveau spnego en envoyant un spnegoinit et un Negociate message.\",React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"a\",{href:\"https://msdn.microsoft.com/en-us/library/cc246561.aspx \"},\"https://msdn.microsoft.com/en-us/library/cc246561.aspx\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"tabulation\"},\"Pour ce qui est du projet l\\u2019impl\\xE9mentation a \\xE9t\\xE9 largement inspir\\xE9e dans un premier temps par la biblioth\\xE8que \\xAB WinAuth \\xBB en Rust afin de g\\xE9n\\xE9rer le challenge/response n\\xE9cessaire \\xE0 l\\u2019authentification, mais la d\\xE9cision a \\xE9t\\xE9 prise par la suite de r\\xE9\\xE9crire ce code afin que cela corresponde davantage \\xE0 nos besoins. \"),React.createElement(\"p\",null,\"Pour le moment, l\\u2019authentification peut \\xEAtre faite localement, sur un contr\\xF4leur de domaine, via un mot de passe ou par Pass-The-Hash. Un bruteforce des users/passwords a \\xE9galement \\xE9t\\xE9 impl\\xE9ment\\xE9 il suffit de fournir une simple wordlist pour que les identifiants soient test\\xE9s.\"),React.createElement(\"ul\",null,React.createElement(\"li\",null,React.createElement(\"a\",{href:\"https://github.com/steffengy/winauth-rs\"},\"biblioth\\xE8que winaut\")),React.createElement(\"li\",null,React.createElement(\"a\",{href:\"http://blog.gentilkiwi.com/tag/ntlm \"},\"Doc NTLM\"))),React.createElement(\"br\",null),\"Lors d\\u2019une authentification NTLM il y a plusieurs possibilit\\xE9s, elle peut \\xEAtre g\\xE9r\\xE9e par :\",React.createElement(\"ul\",null,React.createElement(\"li\",null,\"Pas d\\u2019authentification (Null authentication)\"),React.createElement(\"li\",null,\"LMv1 ou LMv2 : un simple hash de mots de passe clients\"),React.createElement(\"li\",null,\"NTLMv1 ou NTLMv2 : incluant un challenge du serveur (protection contre le rejeu) \"),React.createElement(\"li\",null,\"NTLM 2 : NTLMV1 am\\xE9lior\\xE9 \")),React.createElement(\"p\",{className:\"tabulation\"},\"Le choix est laiss\\xE9 au client. Les serveurs les plus anciens peuvent encore accepter LM, c\\u2019est pourquoi aujourd\\u2019hui la plupart des clients envoie n\\xE9cessairement les deux, des r\\xE9ponses LM et NTLM. \",React.createElement(\"br\",null),\" La configuration sp\\xE9cifique (des clients et des serveurs) d\\xE9pend de certaines valeurs de cl\\xE9s de registre. Donc il n\\u2019y a pas moyen de savoir \\xE0 l\\u2019avance (\\xE0 l\\u2019exception d\\u2019une reconnaissance pr\\xE9alable des versions OS ou fingerprinting) quels types de r\\xE9ponses seront accept\\xE9es par le serveur. Cela explique pourquoi LM est encore envoy\\xE9 malgr\\xE9 son faible niveau de s\\xE9curit\\xE9. En particulier le choix entre NTLMv1 et NTLMv2 ne d\\xE9pend pas des flags n\\xE9goci\\xE9s. \"),\"Pour plus de d\\xE9tails : \",React.createElement(\"br\",null),React.createElement(\"a\",{style:{\"font-size\":\"9px\"},href:\"http://davenport.sourceforge.net/ntlm.html#type3MessageExample\"},\"http://davenport.sourceforge.net/ntlm.html#type3MessageExample\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"tabulation\"},\"NTLM a \\xE9t\\xE9 largement supplant\\xE9 par le protocole d\\u2019authentification Kerberos pour tout ce qui est authentification dans un domaine. C\\u2019est un proc\\xE9d\\xE9 d\\u2019authentification plus moderne et robuste, il n\\xE9cessite un Ticket Granting Server (TGS) pour fonctionner, g\\xE9n\\xE9ralement sur le Contr\\xF4leur de Domaine. Contrairement \\xE0 NTLM, l\\u2019authentification Kerberos est s\\xE9par\\xE9e de SMB, et implique des int\\xE9ractions entre le TGS et le service auquel on essaie d\\u2019acc\\xE9der. Kerberos est stateless, ce qui permet des attaques comme le Golden Ticket. C\\u2019est un proc\\xE9d\\xE9 d\\u2019authentification bas\\xE9 sur le sch\\xE9ma en Tiers-de-confiance, il ne peut pas \\xEAtre utilis\\xE9 dans toutes les situations. Par exemple lorsque les serveurs ne font pas parti du domaine, ou pour des comptes locaux, ou pour l\\u2019acc\\xE8s \\xE0 des ressources sur un domaine non fiable. NTLM continuera encore pour un moment \\xE0 \\xEAtre le m\\xE9canisme d\\u2019authentification le plus utilis\\xE9. \"),React.createElement(\"a\",{href:\"https://blog. https://blog.varonis.fr/explication-de-lauthentificationkerberos/devensys.com/kerberos-principe-de-fonctionnement/\"},\"Principe Kerberos\"),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"tabulation\"},\"Pour la gestion de l\\u2019authentification, le paquet suivant est envoy\\xE9 pour sp\\xE9cifier les versions SMB support\\xE9es par le client, ainsi que d\\u2019autres informations (signature requise par exemple) \"),React.createElement(\"br\",null),\"[Diagramme Negociate Request]\",React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Dans le paquet Negociate Response, une erreur est retourn\\xE9e si le statut n\\u2019est pas STATUT_SUCCESS. G\\xE9n\\xE9ralement, le serveur envoie un negtokeninit dans un message spnego, et c\\u2019est au client de l\\u2019accepter ou d\\u2019en redemander un nouveau avec une session set up request.\"),React.createElement(\"h3\",null,\"Signature/ Chiffrement\")));}}]);return SneakyMercury;}(React.Component);export default SneakyMercury;","map":{"version":3,"sources":["C:/Users/Nico/hackingfornoobs_frontend/src/components/SneakyMercury.js"],"names":["React","Fuzzbunch","Eternalblue","Help","Demo","Interactive","Flow","EternalblueSuccess","SneakyMercury","NSA","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Fuzzbunch from \"../img/fuzzbunch.jpg\"\r\nimport Eternalblue from \"../img/eternalblue.PNG\"\r\nimport Help from \"../img/help_sneakymercury.PNG\"\r\nimport Demo from \"../img/demo_sneakymercury.PNG\"\r\nimport Interactive from \"../img/interactive.PNG\"\r\nimport NSA from \"../img/nsa.svg\"\r\nimport Flow from \"../img/flow.PNG\"\r\nimport EternalblueSuccess from \"../img/eternalbluesuccess.jpg\"\r\n\r\n\r\nclass SneakyMercury extends React.Component {\r\n    render() {\r\n      return (\r\n      <div className=\"article\">\r\n        <h1>Projet SneakyMercury</h1>\r\n        <h2 style={{\"font-size\": \"200%\", \"font-family\": \"Proxima Nova Soft\", \"text-align\": \"center\"}}>(Post-exploitation dans les rseaux Windows)</h2>\r\n        <hr/>\r\n        <div>\r\n          <ul>\r\n            <li><a href=\"#projet\">Le projet</a></li>\r\n            <li><a href=\"#PTH\">Pass-The-Hash</a></li>\r\n            <li><a href=\"#smb\">Le protocole SMB</a></li>\r\n          </ul>  \r\n        </div>\r\n        <div className=\"sneaky_article\">\r\n            <h2>Le Shadow Brokers Leak</h2>\r\n\r\n            <p className=\"tabulation\">Ces dernires annes ont vu l'mergence de cyberattaques de plus en plus sophistiques. Les attaquants comme les agences gouvernementales se servent d'outils customs dvelopps en interne, qui sont parfois sujet  des fuites publiques.<p/> \r\n            <p className=\"tabulation\"></p>L'une d'entre elles a particulirement marqu les esprits, le <strong>Shadow Brokers Leak,</strong> qui contenait les exploits et outils utiliss par la NSA (National Security Agency) et en particulier ceux concernant le <strong>protocole SMB</strong>. Ces exploits dnomms EternalBlue, EternalChampion, EternalRomance et EternalSynergy ont t ensuite r-implments dans des campagnes d'attaques comme le ransomware <strong>WannaCry</strong>. </p>\r\n\r\n            <img id=\"nsa\" src={NSA} alt=\"NSA\"/>\r\n            \r\n            <h2>Le contexte gnral</h2>\r\n            <p className=\"tabulation\">Le leak des Shadow Brokers est une srie de 2 fuites doutils de la NSA survenues en Aot 2016 et Avril 2017. Ces leaks contenaient plusieurs exploits et outils qui furent vols semble-t-il  <strong>lEquation Group</strong>, le groupe oprationnel cyber de la NSA. Cela inclut notamment le fameux exploit <strong>EternalBlue</strong> qui n'a eu de cesse depuis de faire parler de lui. </p>\r\n            <p>Les Shadows Brokers annoncrent publiquement la fuite le 13 aot 2016 sur plusieurs sites et forums comme teaser de la fuite suivante d'autres outils quils avaient galement en leur possession. </p>\r\n            <p>Finalement le 14 avril 2017 fut release le dossier <strong>Lost in Translation</strong>. En 2017, plusieurs cyberattaques ont t lances aprs cet vnement, notamment les fameux ransomwares <strong>WannaCry</strong> et <strong>NotPetya</strong>. </p><br/>\r\n            \r\n            <h2>Les outils de la NSA</h2>\r\n            <p>La premire partie de notre stage consistait en ltude des diffrents outils de la NSA, nous nous sommes particulirement concentrs sur 3 outils : </p>\r\n            \r\n            <p><strong>FUZZBUNCH :</strong> Framework comparable  Metasploit. Gnralement utilis pour gnrer des payloads customs (charge utile servant  infecter une machine cible).</p>\r\n            <p><strong>DOUBLEPULSAR :</strong> Payload utilis avec les exploits SMB. Il sagit dune backdoor7 qui offre des fonctionnalits comme linjection de DLL8 ou lexcution de code malveillant sur les machines infectes. Il est utilis pour installer PeddleCheap qui est un listener9 qui se connecte en retour  Danderspritz. </p>\r\n            <p><strong>DANDERSPRITZ :</strong> Framework graphique de post-exploitation, il couvre entre autre la reconnaissance, la dcouverte du rseau, la dtection dantivirus, lextraction de donnes, la persistance et plein dautres fonctionnalits. </p>\r\n            \r\n            <div>Parmi les diffrentes fonctionnalits : <br/>\r\n                <ul>\r\n                    <li>Monitoring des services sur la machine victime</li>\r\n                    <li>Rcupration dinformations sur les drivers</li>\r\n                    <li>Liste des logiciels et des services en cours dexcution</li>\r\n                    <li>Liste des antivirus prsents</li>\r\n                    <li>Gestion de netstat</li>\r\n                    <li>Dump de mots de passe </li>\r\n                </ul>\r\n            </div>\r\n            <p>Afin de faciliter le monitoring des htes infects, plusieurs options sont disponibles pour prvenir et alerter les analystes</p>\r\n            <p>Danderspritz offre galement des modules ddis  lActive Directory (numration des utilisateurs, des partages rseau, etc) et aux mouvements latraux.</p>       \r\n            <div>Rsum d'une attaque lance  partir de ces outils :\r\n              <ol>\r\n                <li>La victime est infecte avec la backdoor <strong>Doublepulsar</strong> via un exploit (<strong>EternalBlue</strong> par exemple)</li> \r\n                <li>Le listener <strong>PeddleCheap</strong> est lanc dans linterface graphique <strong>Danderspritz</strong>.</li>\r\n                <li>PeddleCheap est upload via la backdoor DoublePulsar.</li>\r\n                <li>PeddleCheap est excut et se connecte au listener</li>  \r\n              </ol>\r\n            [Diagramme Post-exploitation NSA]\r\n            </div>\r\n            <br/>\r\n            <h2>Dmonstration des outils </h2>\r\n            <p>Linterface de base de Fuzzbunch est assez user-friendly : </p>\r\n            <div><img id=\"fuzzbunch\" src={Fuzzbunch} alt=\"Fuzzbunch dmo\"></img></div>\r\n            -> <a href=\"https://www.digital.security/fr/blog/dans-la-boite-outils-dequation-group\">article Digital Security sur l'Equation Group</a><br/><br/>\r\n            <div>Aprs avoir renseign certains champs, comme ladresse IP cible ou le port dcoute, on peut lancer des plugins qui sorganisent en diffrentes catgories :  \r\n              <ul>\r\n                <li><strong>Reconnaissance</strong> (fingerprinting) et check des vulnrabilits exploitables sur la cible : Rpctouch, Smbtouch, et dautres outils de reconnaissance </li>\r\n                <li><strong>Exploitation de vulnrabilits</strong> : Emeraldthread ou la suite Eternal*</li>\r\n                <li><strong>Post-exploitation</strong> aprs infection de lhte : DouplePulsar </li>\r\n              </ul>\r\n              RpcTouch permet de raliser un fingerprinting de la cible, Smbtouch en plus de rcuprer la version et larchitecture du systme dexploitation remonte directement les vulnrabilits exploitables sur la machine cible.\r\n            </div>\r\n\r\n            <br/> \r\n\r\n            <p>Dans l'exemple suivant, la cible est vulnrable  3 exploits dont EternalBlue : \r\n            </p>\r\n            <img id=\"eternalblue_img\" src={Eternalblue} alt=\"eternalblue success\"></img>\r\n            <p className=\"tabulation\">Lattaque a russi, et naura pris quun peu plus de 10 secondes. EternalBlue exploite un buffer overflow au niveau de la stack SMB et s'excute au niveau du Kernel Windows. Aprs on peut dposer une backdoor sur la cible. </p>\r\n            <a href=\"https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue\">Dtails de l'exploit</a>\r\n            \r\n            <hr/>\r\n\r\n            <h2 id=\"projet\">Projet SneakyMercury </h2>\r\n            <h3>Mise en place d'un lab</h3>\r\n            <p className=\"tabulation\">La mise en place dun lab tait ncessaire au projet afin de pouvoir tester l'outil dans un environnement restreint et contrl. La plupart des entreprises de scurit disposent de laboratoires virtuels comme celui-ci, certains sont galement disponibles  lachat. \r\n \r\n            Nous avons choisi de mettre en place l'architecture d'un rseau standard dentreprise,  savoir un environnement Active Directory avec des serveurs (Windows Server) et des machines clientes (32bits et 64bits). Pour la machine attaquante, on se sert dune machine virtuelle (VM) Kali Linux. </p>\r\n            <ul>\r\n              <li><strong>Active Directory</strong> - Collection de services pour la gestion des groupes, des utilisateurs et des machines. Les utilisateurs et les machines sont regroups dans des domaines (ici testinfra.fr)\r\n              \r\n              Tous les services sont grs par un unique serveur, <strong>le Domain Controller (DC)</strong></li>\r\n              <li><strong>DNS</strong> - Service ncessaire pour le fonctionnement de lActive Directory. l'AD se fie  une srie denregistrements DNS pour tablir quels services sont disponibles sur le domaine et ce quils fournissent. Ces enregistrements sont grs automatiquement.</li>\r\n              <li><strong>LDAP</strong> - (Lightweight Directory Access Protocol) Annuaire de gestion des utilisateurs prsents sur le rseau. </li>\r\n              <li><strong>Kerberos</strong> - Service cl responsable de tout ce qui est authentification sur le domaine. Avec le SSO (Single Sign On) il est possible d'utiliser les mmes identifiants pour se connecter sur tous les ordinateurs du domaine.</li>\r\n            </ul>\r\n\r\n            <p>Lensemble de ces services sont installables lors de la mise en place dun Active Directory :</p>\r\n            <a href=\"https://www.psattack.com/articles/20160718/setting-up-an-active-directory-lab-part-1/ \">Mise en place d'un AD</a>\r\n            <br/><br/>\r\n            <h3>Un outil de post-exploitation pour les rseaux Windows</h3>\r\n            <p className=\"tabulation\">Lobjectif de ce projet est de dvelopper un nouvel outil opensource afin dautomatiser la phase de mouvement latral dans un environnement rseau Windows avec Active Directory. L'outil devra tre comparable en termes de fonctionnalits  loutil existant <strong>CrackMapExec</strong> (CME) mais il devra tre dvelopp en RUST plutt quen Python comme c'est le cas pour CME.</p>\r\n            <a href=\"https://github.com/byt3bl33d3r/CrackMapExec \">github de CrackMapExec</a><br/><br/>\r\n            <p>Rust est un langage relativement rcent dvelopp par la fondation Mozilla mais qui possde dj de nombreux contributeurs sur GitHub.</p>\r\n            <div><strong>Les avantages dun dveloppement en RUST ?</strong> <br/>\r\n              <ul>\r\n                <li><strong>Facilit de dploiement</strong> : Pas besoin denvironnement dexcution (portable et multiplateforme), pas de dpendance, on compile le programme vers un binaire excutable quon peut dployer sur le rseau cible.</li>\r\n                <li><strong>Rapidit</strong> : Rust est un langage bas niveau, trs optimis par rapport au langage Python </li>  \r\n                <li><strong>Scurit</strong> : Rust combine programmation bas niveau avec sret mmoire, (pas de garbage collector). Le compilateur garantit que le code est memory safe. La syntaxe du langage et les vrifications du compilateur empchent normment derreurs, pas doverflow ni de race condition ou autres corruptions mmoire.</li>\r\n              </ul>\r\n            </div>\r\n\r\n            <ul id=\"list-links\">\r\n              <li><a href=\" https://doc.rust-lang.org/book/ \">Rust Book</a></li>\r\n              <li><a href=\"https://doc.rust-lang.org/rust-by-example/ \">Rust by example</a></li>\r\n              <li><a href=\"https://aml3.github.io/RustTutorial/\">Rust in 7 programs</a></li>\r\n              <li><a href=\" https://llogiq.github.io/2015/07/30/traits.html \">Rust built-in traits</a></li>\r\n            </ul>      \r\n            <div><strong>Cahier des charges pour loutil :</strong>\r\n              <ul>\r\n                  <li>Authentification sur le rseau Windows : NTLM, Kerberos, Bruteforce de comptes </li>\r\n                  <li>numration : de partages rseaux, d'utilisateurs, de groupes et dautres informations utiles.</li>\r\n                  <li>Commandes : Upload/Download de fichiers, shell interactif des fonctionnalits de loutil </li>\r\n                  <li>Excution de code  distance : PSExec et LOLBAS (Living Off The Land Binaries And Scripts), ensemble de techniques furtives qui se servent des excutables lgitimes prsents sur le systme.</li>\r\n              </ul>\r\n            </div>\r\n            <h3>Dveloppement dune bibliothque SMB en Rust</h3>\r\n            <p className=\"tabulation\">Contrairement  <strong>CrackMapExec</strong> (CME) qui pouvait compter sur la bibliothque SMB en Python <strong>Impacket</strong>, Rust tant un langage relativement rcent, il ny a pas de bibliothque SMB dj exitante. La principale difficult a donc t la rimplmentation from scratch du protocole SMB en Rust. Il sagissait de comprendre le protocole, les mcanismes de gestion de lauthentification sous Windows et de recrafter chaque paquet pour effectuer telle ou telle action.</p>\r\n            <div>SMB (Server Message Block) est le protocole des partages Windows, il inclut notamment :  \r\n              <ul>\r\n                <li>Laccs aux Partages rseau (shares)</li>\r\n                <li>La gestion des imprimantes </li>\r\n                <li>Ladministration de machines distantes </li>\r\n                <li>La lecture et lcriture de fichiers </li>\r\n              </ul>\r\n            </div>\r\n            \r\n            <p className=\"tabulation\">SMB peut galement fonctionner comme protocole de transport avec dautres protocoles rseau Windows. Par exemple le protocole Windows Remote Procedure Call (DCE RPC) permet la communication interprocess. Les diffrents processus peuvent tre sur la mme machine, sur le mme rseau local ou mme selon la configuration,  travers le net. Cela nous permet donc lexcution de code  distance, le management de services ou la gestion ou la modification de cls de registres Windows.</p>\r\n            <p>Pour implmenter la 1re bibliothque SMB libre en RUST nous nous sommes bass sur Impacket qui en propose dj une existante en Python et sur la documentation de Microsoft associe au protocole SMB.</p>\r\n            \r\n            <hr/>\r\n\r\n            <h2>Utilisation de loutil</h2>\r\n            <div className=\"tabulation\">SneakyMercury est un outil en CLI, linterface offre un shell intractif. Quand lutilisateur lance loutil il accde au menu daide lui indiquant les options  fournir (IP cible, nom dutilisateur, mot de passe, nom de domaine)\r\n            <br/>\r\n             Les commandes shell, script et db sont alors disponibles  \r\n              <ul>\r\n                <li>shell ouvre un shell intractif avec un menu daide plus spcifique</li>\r\n                <li>script permet  un utilisateur de lancer ses propres scripts</li>\r\n                <li>db gre en background une base de donnes contenant les credentials dj rcuprs (fonctionnalit non implmente)</li>\r\n              </ul>\r\n            </div>\r\n\r\n            <img id=\"help\" src={Help} alt=\"menu d'aide sneakymercury\"/>\r\n\r\n            <p>Loutil traite lauthentification NTLMv2 et retourne un message de connexion ou derreur. Lutilisateur connect accde alors  la liste des commandes disponibles.</p>\r\n            \r\n            <img id=\"demo\" src={Demo} alt=\"demo sneakymercury\"/>\r\n\r\n            <div>Gnralement la commande suivante est  Connect  qui va permettre la connexion  un partage rseau (share). \r\n            \r\n            Par dfaut, il y a 3 partages rseau, visibles uniquement par ladministrateur du domaine ou ladministrateur local. Pour pouvoir monter ces partages rseau il faut avoir les droits administrateur sur le systme.\r\n            <ul>\r\n              <li>C$ (Disque C)</li>\r\n              <li>ADMIN$ = C:/Windows/</li>\r\n              <li>IPC$</li>\r\n            </ul>\r\n            $=cach\r\n            </div>\r\n            <br/>\r\n            <p className=\"tabulation\">IPC$ est un partage spcial permettant la communication interprocess. Il ne permet pas daccder directement  des fichiers ou des dossiers comme les autres partages rseau mais il fournit une interface de communication avec les autres processus en cours dexcution sur le systme (Remote Procedure Call : DCERPC).  \r\n    \r\n            En fait $IPC expose les named pipes11 sur lesquels on peut alors crire ou lire pour communiquer avec les processus. Chaque data qui est crite sur un named pipe est envoye au processus distant et inversement chaque data crite par un processus sera accessible  partir du named pipe associ. Une fois connect au partage rseau lutilisateur peut lister les fichiers ou se dplacer dans les diffrents dossiers  la recherche de donnes sensibles.</p>\r\n\r\n            <h3>Exploration des partages rseau et commandes Powershell </h3>  \r\n            <p className=\"tabulation\">On peut galement excuter des commandes arbitraires sur la cible grce  la commande PowerShell :</p>    \r\n        \r\n            <img id=\"interactif\" src={Interactive} alt=\"sneakymercury interactif\"/>\r\n\r\n            <h3>Download de fichiers ou upload de codes malveillants</h3>\r\n            <p className=\"tabulation\">La fonctionnalit implmente suivante est l<strong>Upload/Download</strong> de fichiers. Cela peut permettre  lutilisateur de rcuprer les fichiers intressants en local avec la commande download, ou alternativement d'uploader ses propres fichiers ou excutables via la commande upload.</p>\r\n\r\n            <p>Pour implmenter cette fonctionnalit nous nous sommes inspirs de lupload utilis par CrackMapExec (CME).</p>  \r\n            <ul><strong>Dtails upload CME :</strong>\r\n              <li>Premire tape, connexion au share o lon veut uploader (ex : ADMIN$)</li>\r\n              <li>Cration dun fichier (Create Request File) </li>\r\n              <li>Ecriture du fichier, on bufferise les donnes pour les envoyer en boucle si ncessaire (Write Request)</li> \r\n              <li>Fermeture (Close Request)</li>\r\n            </ul>     \r\n\r\n            <p className=\"tabulation\">Le schma prsente les tapes pour ouvrir un fichier sur la machine distante, y crire, et le fermer. On fait lhypothse quune connexion authentifie est dj tablie avant lenvoi de ces paquets, ltablissement de la session et la connexion au partage rseau ont donc dj eu lieu :</p>     \r\n\r\n            <p>[Diagramme d'un upload]</p>     \r\n\r\n            <p className=\"tabulation\">La premire requte permet la cration d'un fichier sur la machine distante. La seconde va initialiser certaines mtadonnes du fichier comme sa taille. On envoie des requtes dcriture dans lesquelles on bufferise les data  transmettre, et lon boucle jusqu la fin du fichier source. Une dernire requte permet la fermeture du fichier distant. Lupload est alors termin.</p>\r\n\r\n            <h3>Enumration des utilisateurs, des domaines et des sessions</h3>    \r\n\r\n            <p className=\"tabulation\">Si lobjectif est la reconnaissance locale ou sur le domaine, lutilisateur peut utiliser les commandes <strong>domains</strong> ou <strong>users</strong>. Elles listent respectivement les domaines auxquels les utilisateurs peuvent se connecter, et les utilisateurs enregistrs. Dautre part si elle est utilise sur un Contrleur de Domaine, la commande users peut lister tous les utilisateurs du domaine :  </p> \r\n\r\n            <p>[Diagramme liste users]</p>     \r\n\r\n            <div>Cette fonctionnalit est base sur le protocole <strong>SAMR</strong> (Security Account Manager Remote) avec les requtes suivantes :  \r\n              <ol>\r\n                <li>Connect request</li>\r\n                <li>EnumDomains</li>\r\n                <li>LookupDomain</li>\r\n                <li>OpenDomain</li>\r\n                <li>EnumDomainUsers</li>\r\n                <li>OpenUser</li>\r\n                <li>QueryUserInfo2</li>\r\n                <li>Close request </li>\r\n              </ol>\r\n            </div>\r\n\r\n            <p className=\"tabulation\">Une requte va initialiser la connexion, la suivante liste les domaines, on parse alors la rponse pour se concentrer sur un domaine en particulier. On ouvre ce domaine et une requte va raliser lnumration des utilisateurs sur celui-ci. Enfin on peut rcuprer certaines informations spcifiques  un utilisateur, avant de fermer avec la dernire requte</p>\r\n\r\n            <p>La capture Wireshark ci-dessous prsente les requtes SAMR dans lordre logique pour lister les utilisateurs.</p>     \r\n\r\n            <p>[Diagramme wireshark num users</p>   \r\n\r\n            <p className=\"tabulation\">Pour notre projet nous avons analys les paquets en utilisant WireShark (logiciel dcoute passive et de capture de paquets rseau). Afin dimplmenter une action particulire (comme lnumration des utilisateurs), il faut envoyer au serveur les paquets dans un ordre prcis, avec des paramtres corrects et les valeurs correspondantes. On a donc du dissquer le protocole pour comprendre les fonctions des diffrents paquets ainsi que les effets des diffrents paramtres.</p>  \r\n            <p>Wireshark et les tests unitaires ont permis de dceler les ventuelles erreurs de valeurs dans les paramtres des paquets ou dans le parsing des rponses. Cette mthodologie pour construire les paquets, les envoyer sur le rseau et parser les rponses, reste valable quelque soit le protocole tudi.</p>\r\n\r\n            <hr/>\r\n\r\n            <h2>Fonctionnalits additionnelles</h2>\r\n            <h3>Windows Remote Code Execution </h3>\r\n\r\n            <div>Plusieurs mthodes sont possibles pour lexcution de code  distance sous Windows : \r\n              <ul>\r\n                <li>Remote Service Control Manager (Named pipe : svcctl)</li> \r\n                <li>Task Scheduler (atexec)</li>\r\n                <li>Windows Management Instrumentation (WMI)</li>\r\n                <li>Remote Registry</li>\r\n                <li>Remote File Access</li>\r\n                <li>Remote Desktop (RDP)</li>\r\n                <li>Windows Remote Management</li>\r\n                <li>MMC20.Application (DCOM) </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <p>Ces diffrentes mthodes sont expliques dans ce lien :</p> \r\n            <a href=\"https://support.microsoft.com/en-us/help/942817/how-to-change-the-remote-uaclocalaccounttokenfilterpolicy-registry-se\">Mthodes d'excution de code  distance</a><br/>\r\n\r\n            <p>Pour ce projet lexcution de code  distance se fait via le protocole <strong>SCMR</strong> (Service Control Manager Remote Protocol) en se basant sur <strong>Psexec</strong> de <strong>SysInternals</strong>.</p>\r\n            \r\n            <p className=\"tabulation\">Lutilisation de commandes internes propres  Windows (lgitimes) permet dviter dcrire des fichiers sur le disque (Fileless) donc est une mthode plus discrte pour viter les dtections via des mcanismes comme lAMSI (Antimalware Scan Interface) ou les sondes IDS</p>\r\n            \r\n            <div>Smb-exec (utilis par CME) permet galement dexcuter du code sur des htes distants. Parmi ses fonctionnalits : \r\n              <ul>\r\n                <li>Dump de hash12 sur les serveurs et machines</li>\r\n                <li>Enregistrement des registres HKLM (HKEY_LOCAL_MACHINE) et de la base SAM (Security Account Manager)</li>\r\n                <li>Recherche de fichiers intressants (ex : unattended.xml contenant souvent des mots de passe en clair)</li>\r\n              </ul> \r\n            </div>\r\n\r\n              <p>\r\n              Il a galement lavantage dtre peu dtect en comparaison des payloads du framework Metasploit (bas sur psexec de SysInternals). <br/>   <br/>\r\n    \r\n              <a href=\"https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbexec.py\">github de smbexec</a>  \r\n              </p>\r\n              <br/>\r\n          \r\n              <div>\r\n              <strong>Dtails de Smb-exec:</strong>\r\n              <ol>\r\n                <li>Premire tape, connexion  IPC$ et cration svcctl (Create Request)</li>\r\n                <li>Rcupration du Context Handle (Open SC Manager Request)</li>\r\n                <li>Cration dun Named service spcifiant la commande  excuter dans le path du binaire (Create Service Request). Cette commande redirige l'output vers des fichiers temporaires qui seront tlchargs ensuite.</li>\r\n                <li>Dmarrage du service (Start Service)</li>\r\n                <li>Lecture de l'output crite dans le fichier temporaire (Read Request)</li>\r\n                <li>Suppression du service (Delete Service) </li>\r\n                <li>Fermeture de lhandle attribu (Close Handle Request)</li>\r\n              </ol> \r\n              </div>\r\n\r\n\r\n              <p className=\"tabulation\">Psexec (dvelopp par SysInternals), il sagit dun outil dadministration  distance de Windows, qui a longtemps t loutil favori pour tous les mouvements latraux dans un environnement Active Directory. Il utilise le protocole SMB pour se connecter  une machine distante et y lancer un excutable. En principe, il cre un  named pipe  qui permet dexcuter de manire interactive des commandes avec RemComSvc. En ralit il les excute localement puis exporte les rsultats  travers SMB. Bien quil soit encore utilis de manire lgitime pour effectuer des tches dadministration il facilite grandement la tche aux attaquants. </p>\r\n\r\n              <p>Voici lexplication dtaille tire du blog rapid7 : PSExec has a Windows Service image inside of its executable. It takes this service and deploys it to the Admin share on the remote machine. It then uses the DCE/RPC interface over SMB to access the Windows Service Control Manager API. It turns on the PSExec service on the remote machine. The PSExec service then creates a named pipe that can be used to send commands to the system. </p>\r\n\r\n              <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/psexec\">Documentation Microsoft Psexec</a><br/>\r\n              <a href=\"https://blog.rapid7.com/2013/03/09/psexec-demystified/\">Explications Psexec additionnelles</a><br/><br/>\r\n\r\n              <strong>Dtails des tapes de Psexec : </strong>\r\n              Comparable  Smbexec mais diffre dans le fait quil upload toujours un fichier sur la machine distante. \r\n\r\n              <ol>\r\n                <li>Cration de psexecsvc.exe sur le share $ADMIN (Create Request File)</li>\r\n                <li>criture sur psexcsv de la commande  excuter sur le fichier local ou des data du binaire  uploader (Write Request) </li>\r\n                <li>Connexion  SCMR via DCERPC (Bind Request)</li>\r\n                <li>Rcupration du context handle </li>\r\n                <li>Cration du service, chiffr sous Wireshark (Create Service Request)</li>\r\n                <li>Fermeture du service (Close Service Handle Request)</li>\r\n                <li>Commande (Open Service Request)</li>\r\n                <li>Dmarrage du service (Start Service Request)</li>\r\n                <li>Requte le statut du service (Query Service Status Request)</li>\r\n                <li>Cration de PSEXESVC (Create Request File)</li>\r\n                <li>Rcupration dinformation (Info Request/ IOCTL Request)</li>\r\n                <li>criture des data (Write Request)</li>\r\n                <li>Lecture des data (Read Request)</li>\r\n                <li>Cration du fichier pour stdin (Create Request)</li>\r\n                <li>Cration du fichier pour stdout (Create Request)</li>\r\n                <li>Cration du fichier pour stderr (Create Request)</li>\r\n              </ol>\r\n              Aprs chaque commande : criture sur stdin (Write Request) et lecture sur stdout (Read Request) \r\n              <img id=\"flow\" src={Flow} alt=\"flowgraph\" />\r\n\r\n              <h2 id=\"PTH\">Pass The Hash (PTH)</h2>\r\n              <p className=\"tabulation\">Lutilisateur peut galement choisir de sauthentifier en utilisant un hash de mot de passe (NTLMv2), cela permet tout ce qui est attaque du type Pass-The-Hash. \r\n              \r\n              Les mcanismes d'authentification sont bass sur un mot de passe que la plupart du temps les utilisateurs ne doivent saisir qu'une seule et unique fois. Ce dernier sera hash et cest ce hash qui sera utilis par la suite.  Ainsi pour un attaquant cela revient au mme de connatre la valeur du hash ou bien le mot de passe lui-mme. Une attaque Pass-The-Hash facilite grandement les intrusions dans un rseau dans la mesure o mme les mots de passe dune grande complexit peuvent tre facilement contourns. \r\n              </p>\r\n\r\n              <ul>\r\n                <li> <a href=\"https://www.melani.admin.ch/melani/fr/home/documentation/rapports/rapportstechniques/attaques--pass-the-hash-.html \">documentation pass the hass</a></li>\r\n                <li>   <a href=\"https://attack.stealthbits.com/pass-the-hash-attack-explained \">explications pass the hash</a></li>\r\n              </ul>\r\n             \r\n              <p className=\"tabulation\">Par ailleurs, les attaques Pass-The-Hash sont trs difficiles  dtecter au niveau du rseau car il est complexe de savoir quel utilisateur devrait tre loggu sur telle machine et de pratiquer une politique de scurit assez fiable pour savoir  tout moment quels comptes ont droit daccs  telle ressource.</p>\r\n\r\n              <h2>Null Session</h2>\r\n              <p className=\"tabulation\">Il sagit dune vulnrabilit classique dans les rseaux Windows qui consiste  se connecter en connexion anonyme  un partage rseau cach IPC$ (share rseau utilis pour les communications interprocess). Cela permet ainsi de rcuprer de nombreuses informations sur la configuration de la machine, les utilisateurs, les noms des partages rseau, et mme de modifier des parties du registre de la machine distante.</p>\r\n\r\n              <ul>\r\n                <li><a href=\"https://sensepost.com/blog/2018/a-new-look-at-null-sessions-and-user-enumeration/\">lien1</a></li>\r\n                <li><a href=\"https://www.beyondsecurity.com/scan_pentest_network_vulnerabilities_null_session_availab lesmb\">lien2</a></li>\r\n                <li><a href=\"http://smallvoid.com/article/winnt-null-session.html\">lien3</a></li>\r\n                <li> <a href=\"https://www.youtube.com/watch?v=VvX7JHzzSA8\">lien4</a></li>\r\n              </ul>\r\n\r\n              <p className=\"tabulation\">Pour utiliser la nulle session dans notre outil, il faut changer un flag lors de la ngociation de session (afin de rendre la connexion anonyme) et supprimer toutes les rponses au challenge.</p>\r\n \r\n              Pour dsactiver la nulle session sous Windows, il suffit de modifier le registre comme suit : <br/>\r\n              HKEY\\SYSTEM\\CurrentControlSet\\Control\\Lsa: <br/> \r\n               RestrictAnonymous = 1 <br/> \r\n               Restrict AnonymousSAM = 1 <br/>\r\n               EveryoneIncludesAnonymous = 0 <br/><br/>\r\n\r\n  \r\n              <p>On peut galement limiter ses accs aux partages rseau en ajoutant un champ <strong>RestrictNullSessAccess</strong>de valeur 1 dans la cl de registre suivante :<br/>\r\n              <strong style={{'font-size':'9px'}}>HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters</strong>  \r\n              </p>\r\n              \r\n\r\n\r\n              <h2>Bruteforce de mots de passe</h2>\r\n              <p className=\"tabulation\">Pour grer le bruteforce de mots de passe au niveau de lauthentification SMB on a implment l'utilisation d'une liste de noms dutilisateurs/mots de passe plutt quun mot de passe unique afin de tester lauthentification pour une liste spcifique de cible. \r\n              Lorsque des identifiants valides sont trouvs ils sont automatiquement ajouts dans la base de donnes qui devrait  terme recenser tous les identifiants trouvs sur le rseau au cours du pentest, y compris les identifiants dans les fichiers des partages rseaux (ce qui est arrive frquemment).</p>\r\n\r\n              <h2>La suite Eternal*</h2>\r\n              \r\n              MS17-010 contient les exploits dvelopps par la NSA qui ciblent Microsoft Windows, ces exploits ont notamment t r-implments dans les ransomware WannaCry et NotPetya. \r\n\r\n              <ol>\r\n                <li>CVE-2017-0146 (EternalChampion/EternalSynergy) : exploite une race condition avec les Transaction requests</li>\r\n                <li>CVE-2017-0143 (EternalRomance/EternalSynergy) : exploite une confusion de type entre WriteAndX et Transaction requests </li>\r\n              </ol>\r\n\r\n              Sous Metasploit : exploit/windows/smb/ms17_010_psexec\r\n\r\n              <ul>\r\n                <li>1. Le pare feu doit permettre le trafic SMB</li>  \r\n                <li>2. La cible doit utiliser la version du protocole SMBv1</li>  \r\n                <li>3. Il ne doit pas y avoir la mise  jour du patch de la MS17-010</li>  \r\n                <li>4. La connexion anonyme  lIPC$ et au named pipe doivent tre autorises</li> \r\n              </ul>\r\n\r\n              <img id=\"eternalbluesuccess\" src={EternalblueSuccess} alt=\"exploit eternalblue\"/>\r\n\r\n              <p className=\"tabulation\">EternalBlue ne ncessite pas dtre authentifi. EternalRomance, EternalSynergy et EternalChampion permettent dobtenir une session administrateur  partir dun compte aux privilges limits. \r\n              Dans le cadre du projet, EternalBlue a t implment en Rust afin de pouvoir lintgrer dans loutil. </p>\r\n\r\n              <h2 id=\"smb\">Server Message Block (SMB)</h2>\r\n              <h3>Prsentation</h3>\r\n              <p className=\"tabulation\">Il existe plusieurs versions de la suite protocolaire Microsoft SMB : SMB 1, SMB 2.0, SMB 2.1, SMB 3.0, SMB 3.0.2, SMB 3.1.1<br/>  Les versions SMB 2.X et SMB 3.X sont assez proches mais radicalement diffrents de la version SMB1. <br/>Ce projet sest concentr sur limplmentation de SMB2.1, le tableau suivant prsente les versions du protocole SMB associes aux diffrents systmes dexploitation : </p>\r\n\r\n              <p>SMB peut tre implment sur le TCP ou via NETBIOS. Ce projet se concentre sur le SMB over TCP (Direct Hosted SMB). Les paquets seront crafts de manire  indiquer que le protocole est lanc over TCP avec un header qui prcisera  chaque fois laction  raliser et donc la nature des data qui suivent. </p>\r\n\r\n              <p>Pour notre projet nous nous sommes concentrs sur la version SMB2.1 utilisant le header SYNC packets, et uniquement du cot client. Pour se faire nous nous sommes inspirs du client smb dImpacket ainsi que de la documentation de Windows. </p>\r\n\r\n              <p>En mode sync, un thread lance une opration I/O et entre immdiatement dans une phase dattente jusqu ce que la requte I/O soit acheve. </p>\r\n\r\n              <p>Le header SMB (SYNC) se prsente comme suit:</p>\r\n\r\n              [Diagramme header SMB]\r\n \r\n              <ul>\r\n                <li>4 premiers octets : identification du protocole SMB2      SMB2:0x424d53fe </li>\r\n                <li>2 suivants : taille du header</li>\r\n                <li>2 octets : Credit Charge  0x0000 (valeur fournie par le client au serveur et limite le nombre de requtes exceptionnelles quun client peut envoyer au serveur)</li>\r\n                <li>2 octets : Channel Sequence 0x0000</li>\r\n                <li>2 octets : Reserved, 0x0000</li>\r\n                <li>2 octets : Command (lun des paramtres les plus importants car il dcrit le type de paquet qui va tre envoy) </li>\r\n                <li>2 octets : Credits requested </li>\r\n                <li>4 octets : flags<br/>- requte : 0x00000000 <br/>- rponse : 0x00000001</li>\r\n                <li>8 octets : message ID <br/>    - incrmentation  partir de 0 pour chaque requte envoye <br/> - logique de suivi au niveau paquets de la communication SMB</li>\r\n                <li>4 octets : Process ID - 0x0000feff </li>\r\n                <li>4 octets : Tree ID <br/> - 0x00 jusqu la requte tree connect  <br/> \r\n                - 0x01 puis gal  1 aprs connexion</li>\r\n                <li>8 octets : Session ID <br/>- 0x00 jusqu la requte session setup, aprs identifie la session</li>\r\n                <li>16 octets : Signature ID <br/>  - utilis si le paquet est sign </li>\r\n              </ul>\r\n\r\n              <a href=\"https://msdn.microsoft.com/en-us/library/cc246529.aspx\">documentation source</a>\r\n              <br/>\r\n              <br/>\r\n              <p className=\"tabulation\">Pour les messages, il a fallu les crafter de zro en sinspirant de la documentation Microsoft et du code dImpacket, voici les diffrents paquets relatifs au protocole SMB que lon a pu implmenter au cours du projet : </p>\r\n\r\n              <ul>\r\n                <li>Negotiate: message initial, ngociation pour lauthentification</li>\r\n                <li>Session Setup: mcanisme authentification</li>\r\n                <li>Tree Connect/Disconnect: demande de connexion  un Partage rseau</li>\r\n                <li>Logoff: message pour la dconnexion </li>\r\n                <li>Read: message de lecture de data </li>\r\n                <li>Write: message dcriture de data </li>\r\n                <li>Create: message daccs/de cration/de suppression dun fichier</li>\r\n                <li>Query Directory: rcupration dinformation sur un dossier </li>\r\n                <li>Get Info: rcupration dinformations sur les fichiers et/ou autres objets </li>\r\n              </ul>\r\n\r\n              Grce  ces paquets on a ainsi pu implmenter les fonctionnalits suivantes : \r\n\r\n              <ul>\r\n                <li>Ouverture et fermeture dune connexion SMB </li>\r\n                <li> Authentification (combin avec limplmentation Windows GSS-API/NTLMSSP)  Login </li>\r\n                <li>Connexion  un partage rseau </li>\r\n                <li>Liste des partages rseau </li>\r\n                <li>Dplacement dans les dossiers dun partage </li>\r\n                <li>Upload dun fichier sur un partage </li>\r\n                <li>Download dun fichier prsent sur un partage </li>\r\n              </ul>\r\n\r\n              <h3>Authentification</h3>\r\n\r\n              Le graphe suivant donne une vue densemble du processus dauthentification SMB2 (login) : \r\n              <br/>\r\n              [Diagrammme authentification SMB2]\r\n              <br/>\r\n\r\n              <p>Dans le premier paquet le client reoit le token GSS du serveur. Il sagit dun spnego qui est utilis pour choisir le type dauthentification qui interviendra entre le client et le serveur.</p>\r\n\r\n              <p>SPNEGO est une spcification standard dfinie dans Simple and Protected GSS-API Negotiation Mechanism, et est en charge de lauthentification permettant l'accs  une ressource scurise identifie dans la requte HTTP.</p>\r\n\r\n              Le spnego inclut les paramtres : \r\n\r\n              <ul>\r\n                <li>mechtypes : qui dcrit les mcanismes de scurit disponibles </li>\r\n                <li>mechtoken : le token relatif  la session </li>\r\n                <li>dautres informations</li>\r\n              </ul>\r\n\r\n              Dans le cas dune session NTLM, le client va initier un nouveau spnego en envoyant un spnegoinit et un Negociate message.\r\n\r\n              <br/>\r\n              <br/>\r\n\r\n              <a href=\"https://msdn.microsoft.com/en-us/library/cc246561.aspx \">https://msdn.microsoft.com/en-us/library/cc246561.aspx</a>\r\n              <br/>\r\n              <br/>\r\n\r\n              <p className=\"tabulation\">Pour ce qui est du projet limplmentation a t largement inspire dans un premier temps par la bibliothque  WinAuth  en Rust afin de gnrer le challenge/response ncessaire  lauthentification, mais la dcision a t prise par la suite de rcrire ce code afin que cela corresponde davantage  nos besoins. </p>\r\n\r\n              <p>Pour le moment, lauthentification peut tre faite localement, sur un contrleur de domaine, via un mot de passe ou par Pass-The-Hash. Un bruteforce des users/passwords a galement t implment il suffit de fournir une simple wordlist pour que les identifiants soient tests.</p>\r\n\r\n              <ul>\r\n                <li><a href=\"https://github.com/steffengy/winauth-rs\">bibliothque winaut</a></li>\r\n                <li><a href=\"http://blog.gentilkiwi.com/tag/ntlm \">Doc NTLM</a></li>\r\n              </ul>\r\n              \r\n              <br/>\r\n\r\n              Lors dune authentification NTLM il y a plusieurs possibilits, elle peut tre gre par : \r\n\r\n              <ul>\r\n                <li>Pas dauthentification (Null authentication)</li>\r\n                <li>LMv1 ou LMv2 : un simple hash de mots de passe clients</li>\r\n                <li>NTLMv1 ou NTLMv2 : incluant un challenge du serveur (protection contre le rejeu) </li>\r\n                <li>NTLM 2 : NTLMV1 amlior </li>\r\n              </ul>\r\n\r\n              <p className=\"tabulation\">Le choix est laiss au client. Les serveurs les plus anciens peuvent encore accepter LM, cest pourquoi aujourdhui la plupart des clients envoie ncessairement les deux, des rponses LM et NTLM. <br/> La configuration spcifique (des clients et des serveurs) dpend de certaines valeurs de cls de registre. Donc il ny a pas moyen de savoir  lavance ( lexception dune reconnaissance pralable des versions OS ou fingerprinting) quels types de rponses seront acceptes par le serveur. Cela explique pourquoi LM est encore envoy malgr son faible niveau de scurit. En particulier le choix entre NTLMv1 et NTLMv2 ne dpend pas des flags ngocis. </p>\r\n\r\n              Pour plus de dtails : <br/>\r\n              <a style={{\"font-size\":\"9px\"}} href=\"http://davenport.sourceforge.net/ntlm.html#type3MessageExample\">http://davenport.sourceforge.net/ntlm.html#type3MessageExample</a>\r\n              <br/>\r\n              <br/>\r\n\r\n              <p className=\"tabulation\">NTLM a t largement supplant par le protocole dauthentification Kerberos pour tout ce qui est authentification dans un domaine. Cest un procd dauthentification plus moderne et robuste, il ncessite un Ticket Granting Server (TGS) pour fonctionner, gnralement sur le Contrleur de Domaine. Contrairement  NTLM, lauthentification Kerberos est spare de SMB, et implique des intractions entre le TGS et le service auquel on essaie daccder. Kerberos est stateless, ce qui permet des attaques comme le Golden Ticket. Cest un procd dauthentification bas sur le schma en Tiers-de-confiance, il ne peut pas tre utilis dans toutes les situations. Par exemple lorsque les serveurs ne font pas parti du domaine, ou pour des comptes locaux, ou pour laccs  des ressources sur un domaine non fiable. NTLM continuera encore pour un moment  tre le mcanisme dauthentification le plus utilis. </p>\r\n\r\n              <a href=\"https://blog. https://blog.varonis.fr/explication-de-lauthentificationkerberos/devensys.com/kerberos-principe-de-fonctionnement/\">Principe Kerberos</a>\r\n              <br/>\r\n              <br/>\r\n\r\n              <p className=\"tabulation\">Pour la gestion de lauthentification, le paquet suivant est envoy pour spcifier les versions SMB supportes par le client, ainsi que dautres informations (signature requise par exemple) </p>\r\n              <br/>\r\n              [Diagramme Negociate Request]\r\n              <br/>\r\n              <br/>\r\n\r\n              <p>Dans le paquet Negociate Response, une erreur est retourne si le statut nest pas STATUT_SUCCESS. Gnralement, le serveur envoie un negtokeninit dans un message spnego, et cest au client de laccepter ou den redemander un nouveau avec une session set up request.</p>\r\n\r\n              <h3>Signature/ Chiffrement</h3>\r\n        </div>\r\n      </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  export default SneakyMercury;  "]},"metadata":{},"sourceType":"module"}